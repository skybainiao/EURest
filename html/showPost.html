<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>showPost</title>
  <!-- other meta tags, styles etc. -->
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-storage-compat.js"></script>

  <style>
    .images-slider {
      display: flex;
      overflow-x: auto;
      white-space: nowrap;
    }

    .images-slider img {
      margin-right: 10px;
    max-width: 300px;
    height: auto;
    }
  </style>
</head>

<body>

<div>Test</div>
<div class="post-content">
  <div class="images-slider">
    <!-- Images will be populated dynamically -->
  </div>

  <div class="post-details">
    <!-- Post details will be populated dynamically -->
  </div>
</div>

<!-- Firebase and other JS scripts -->
<script>
  let firebaseConfig = {
    apiKey: "AIzaSyABXKTeI2T16mETkhYohvu4Y1X20hvL3cU",
    authDomain: "eufun-f0a72.firebaseapp.com",
    databaseURL: "https://eufun-f0a72-default-rtdb.europe-west1.firebasedatabase.app/",
    projectId: "eufun-f0a72",
    storageBucket: "eufun-f0a72.appspot.com",
    messagingSenderId: "1041084911229",
    appId: "1:1041084911229:web:4df4ec093dcf32b2696b14",
    measurementId: "G-PQ3K5KZ2NJ"
  };
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  window.onload = function() {
    const postId = getPostIdFromURL();
    fetchPostDetails(postId);
  }

  function getPostIdFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('id');
  }

  function fetchPostDetails(postId) {
    const postRef = database.ref(`shopDetails/${postId}`);
    postRef.once('value').then(snapshot => {
      const post = snapshot.val();

      if (!post) {
        console.error('Post not found or is empty.');
        return;
      }

      populatePostDetails(post);

      const imageFolderPath = `shopImages/${post.shopName}/${postId}/`;
      populateImages(imageFolderPath);
    });
  }

  function populatePostDetails(post) {
    const postDetailsDiv = document.querySelector('.post-details');
    // Use post data to populate the postDetailsDiv. Example:
    postDetailsDiv.innerHTML = `
            <h1>${post.title}</h1>
            <p>${post.description}</p>
            <!-- add other post details -->
            `;
  }

  function populateImages(imageFolderPath) {
    const imagesSliderDiv = document.querySelector('.images-slider');
    const imageFolderRef = firebase.storage().ref(imageFolderPath);

    imageFolderRef.listAll().then(result => {
      result.items.forEach(imageRef => {
        imageRef.getDownloadURL().then(url => {
          const img = document.createElement('img');
          img.src = url;
          imagesSliderDiv.appendChild(img);
        });
      });
    });
  }
</script>
</body>

</html>
